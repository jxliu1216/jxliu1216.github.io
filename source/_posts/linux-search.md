---
title: Linux之搜索命令
date: 2021-10-27 22:52:47
tags:
- 通配符
- 正则表达式
- find
- grep
categories: Linux
---



在使用Linux的时候，文件搜索和过滤是我们经常需要使用的功能。在文件搜索和过滤的过程中，find和grep是使用频率非常高的两个命令。这两个命令的使用过程中涉及到字符串模式匹配，也就是正则表达式。因此，本文首先介绍通配符和正则表达式的概念，然后介绍find和grep命令。

<!--more-->

### 1. 通配符

通配符一般在Linux里用于文件名匹配，它是由shell解析的，比如ls等命令。Linux中常见的通配符如下表所示：

| 通配符                | 含义                                       | 示例                                                    |
| --------------------- | ------------------------------------------ | ------------------------------------------------------- |
| *                     | 匹配0或者多个字符                          | a*b表示a与b之间可以任意长度的字符                       |
| ?                     | 匹配任意一个字符                           | a?b表示a与b之间必须有一个字符，可以是任意一个字符       |
| [list]                | 匹配list中的任意一个字符                   | a[xyz]b表示a与b之间有x，y，z中的一个字符                |
| [^list]               | 匹配除list中的任意单一字符                 | a\[^0-9]b表示a与b之间必须有一个字符，但不能是阿拉伯数字 |
| [c1-c2]               | 匹配c1-c2中的任意单一字符                  | a[0-9]b表示a与b之间必须有一个字符，但必须是阿拉伯数字   |
| [^c1-c2]              | 匹配不在c1-c2中的任意字符                  | a\[^0-9]表示a与b之间必须有一个字符，但不能是阿拉伯数字  |
| {string1,string2,...} | 匹配string1或stirng2或者更多字符串中的一个 | a{abc,xyz,123}b，a与b之间是abc，xyz,123之一             |

### 2. 正则表达式

正则表达式是用来处理字符串的，进行过滤和筛选，常用于Linux三剑客grep，sed和awk。正则表达式分为基础正则表达式和扩展正则表达式。扩展正则表达式相对于基础正则表达式，对一些元字符的使用不需要转移，同时也增加了一些元字符。使用扩展正则表达的话，通常需要在命令后添加参数，来表明使用扩展正则表达式进行匹配。

基础正则表达式有如下：

| 正则表达式  | 含义                                     |
| ----------- | ---------------------------------------- |
| ^           | 从行首开始匹配                           |
| $           | 从行尾开始匹配                           |
| ^$          | 空字符                                   |
| .           | 匹配除换行符外的任意一个字符             |
| *           | 前面的字符出现0次或任意多次              |
| .*          | 任意字符串                               |
| []          | 匹配括号中指定的任意一个字符，只匹配一次 |
| [^]         | 匹配除括号里的字符之外的任意一个字符     |
| [-]         | 匹配一个范围内的任意一个字符             |
| \\{n\\}     | 前面的字符恰好出现n次                    |
| \\{n,\\}    | 前面的字符出现不少于n次                  |
| \\{,n\\}    | 前面的字符出现不多于n次                  |
| \\{n1,n2\\} | 前面的字符至少出现n1次，至多出现n2次     |

扩展正则表达式相对与基本正则表达式，多了一些元字符，同时不需要使用\对特殊符号进行转义。例如：在基本正则表达式中，前面字符出现n次，需要用\\{n\\}来表示；而在扩展正则表达式中，仅需要使用{n}来表示。扩展表达式可以分为如下几个部分：

- **字符匹配**

  | 正则表达式 | 含义                         |
  | ---------- | ---------------------------- |
  | .          | 匹配任意单个字符             |
  | []         | 匹配指定范围内的任意单个字符 |
  | [^]        | 匹配指定范围外的任意单个字符 |

- **次数匹配**

  | 正则表达式 | 含义                                     |
  | ---------- | ---------------------------------------- |
  | *          | 匹配前面的字符任意次（0次，1次，或多次） |
  | ？         | 匹配前面的字符0次或1次                   |
  | +          | 匹配前面的字符1次或者多次                |
  | {m}        | 匹配前面的字符m次                        |
  | {m, n}     | 匹配前面的字符至少m次，至多n次           |
  | {m,}       | 匹配前面的字符至少m次                    |
  | {,n}       | 匹配前面的字符至多n次                    |

- **位置锚定**

  | 正则表达式 | 含义     |
  | ---------- | -------- |
  | ^          | 行首锚定 |
  | $          | 行尾锚定 |
  | \\<        | 词首锚定 |
  | \\>        | 词尾锚定 |

  解释一下词首锚定和词尾锚定，这两个是对单词进行操作的。因为正则表达式是对字符串进行处理的，如果一个单词中间有符合模式的字符串，那么就会匹配成功。但是有时候我们是想对单词进行匹配的，这时候就要利用\\<和\\>了。举个例子：

  例如有如下的字符串：testscript script scripttest

  - script：上述三个均能匹配上
  - \\<script：只能匹配scripttest和script
  - script\>：只能匹配testscript和script
  - \\<script\\>：只能匹配script

  <img src="https://jxliu-picbed.oss-cn-shanghai.aliyuncs.com/img/image-20211031182453041.png" alt="image-20211031182453041" style="zoom:67%;" />

### 3. find命令

find命令用来在指定目录下查找文件，会递归的在子目录下进行同样的查找操作。find命令的语法格式如下：

```bash
find path -option
```

其中，path为需要查找的目录，-option为查找条件。find中的查找条件非常多，这里列几个常用的：

- -name "name"：根据文件名进行查找
- -iname "name"：根据文件名进行查找，但是忽略大小写
- -type c：根据文件类型进行查找

还有很多其他的，就不一一罗列了

### 4. grep命令

grep命令用于查找文件里符号条件的字符串，如果发现符合条件的字符串，则将文件中包含该字符串的那一行打印出来。grep命令的使用语法如下：

```bash
grep [-options] pattern file/dir
```

其中pattern为需要匹配的模式，可以使用正则表达式。常用的options有如下：

- -E：使用扩展正则表达式
- -n：显示行号
- -v：反向选取，显示不包含匹配样式的行
- -q：不显示任何信息

